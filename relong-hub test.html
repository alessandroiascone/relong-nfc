<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Re Long Informatica, Telefonia, Energia & Assistenza PC</title>
  <meta name="description" content="Hub Re Long: Smartphone a rate senza busta paga, offerte Business, Energia Casa e Assistenza PC. Marano di Napoli. Tel 08119578844.">
  <meta name="theme-color" content="#0a0a0a">
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='256' height='256' viewBox='0 0 256 256'%3E%3Crect width='256' height='256' rx='56' fill='%230a0a0a'/%3E%3Cpath d='M60 176l68-96l68 96' fill='none' stroke='%23ff3b1a' stroke-width='20' stroke-linecap='round' stroke-linejoin='round'/%3E%3Ccircle cx='128' cy='96' r='14' fill='%23ff9a1a'/%3E%3C/svg%3E" />
  <link rel="preconnect" href="https://wa.me">
  <link rel="preconnect" href="https://maps.app.goo.gl">
  <link rel="preconnect" href="https://www.google.com">
  <style>
    *{box-sizing:border-box;margin:0;padding:0;-webkit-font-smoothing:antialiased}
    :root{--bg1:#0a0a0a;--bg2:#000;--brand1:#ff0000;--brand2:#ff7b00;--muted:rgba(255,255,255,.72);--muted2:rgba(255,255,255,.5);--card:rgba(20,20,20,.94);--stroke:rgba(255,255,255,.08);--wa1:#25D366;--wa2:#128C7E;--focus:#ffd166}
    @keyframes fadeUp{0%{opacity:0;transform:translateY(14px)}100%{opacity:1;transform:translateY(0)}}
    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.06)}}
    @media (prefers-reduced-motion:reduce){*{animation:none!important;transition:none!important}}

    /* Loader */
    #rl-loader{position:fixed;inset:0;z-index:99999;display:grid;place-items:center;background:radial-gradient(circle at 20% 20%, var(--bg1) 0%, var(--bg2) 70%);transition:opacity .45s ease, visibility .45s ease}
    #rl-loader.hidden{opacity:0;visibility:hidden}
    .rl-loading-text{margin-top:18px;font:700 12px/1.2 system-ui,-apple-system,Inter,Roboto,sans-serif;color:rgba(255,255,255,.75);letter-spacing:.06em;text-transform:uppercase}
    .rl-cube{position:relative;width:84px;height:84px;transform-style:preserve-3d;animation:rl-rotate 2.6s linear infinite;filter:drop-shadow(0 16px 42px rgba(255,90,0,.35))}
    .rl-cube .face{position:absolute;inset:0;background:linear-gradient(135deg,var(--brand1),var(--brand2));border:1px solid rgba(255,255,255,.12);border-radius:10px;opacity:.96}
    .rl-cube .f1{transform:translateZ(42px)} .rl-cube .f2{transform:rotateY(180deg) translateZ(42px)}
    .rl-cube .f3{transform:rotateY(90deg) translateZ(42px)} .rl-cube .f4{transform:rotateY(-90deg) translateZ(42px)}
    .rl-cube .f5{transform:rotateX(90deg) translateZ(42px)} .rl-cube .f6{transform:rotateX(-90deg) translateZ(42px)}
    @keyframes rl-rotate{0%{transform:rotateX(-18deg) rotateY(0)}50%{transform:rotateX(18deg) rotateY(180deg)}100%{transform:rotateX(-18deg) rotateY(360deg)}}
    @media (prefers-reduced-motion:reduce){.rl-cube{animation:none}}

    html.rl-lock, body.rl-lock{overflow:hidden}
    body{font-family:system-ui,-apple-system,Inter,Roboto,sans-serif;background:radial-gradient(circle at 20% 20%,var(--bg1) 0%, var(--bg2) 70%);color:#fff;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}

    /* 3D Spotlight */
    .spotlight{position:fixed;inset:0;pointer-events:none;z-index:0;opacity:.25;background:radial-gradient(600px circle at 50% 50%, rgba(255,123,0,.5), rgba(255,0,0,.15) 40%, transparent 60%)}
    .spotlight.softer{opacity:.15}

    .wrap{position:relative;z-index:1;width:100%;max-width:920px;display:grid;gap:22px;padding-bottom:110px}
    @media(max-width:480px){.wrap{padding-bottom:130px}}

    /* Black Friday floating bar */
    .bf-bar{position:fixed;top:12px;left:50%;transform:translateX(-50%);z-index:10000;display:flex;gap:10px;align-items:center;background:linear-gradient(90deg,#ff0000,#ff7b00);color:#000;padding:10px 14px;border-radius:999px;box-shadow:0 18px 40px rgba(255,90,0,.45);font-weight:900}
    .bf-bar .timer{font-variant-numeric:tabular-nums;background:rgba(0,0,0,.08);padding:6px 10px;border-radius:999px}
    .bf-bar a{color:#000;text-decoration:none;font-weight:900}

    .head{text-align:center;padding:44px 8px 0 8px}
    .brand{display:inline-flex;gap:10px;align-items:center;font-size:24px;font-weight:900;letter-spacing:-.04em;animation:fadeUp .5s ease both;will-change:transform}
    .status-pill{font-size:11px;font-weight:900;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.18)}
    .status-open{background:linear-gradient(90deg,#00d27a,#22c55e);color:#000;border-color:transparent}
    .status-closed{background:linear-gradient(90deg,#ff0000,#ff7b00);color:#000;border-color:transparent}
    .sub{font-size:12px;color:var(--muted);margin-top:6px;animation:fadeUp .6s ease both}

    .grid{display:grid;grid-template-columns:1fr;gap:16px}
    @media(min-width:720px){.grid{grid-template-columns: 1fr 1fr}}
    @media(min-width:1024px){.grid{grid-template-columns: 1fr 1fr 1fr}}

    .card{position:relative;background:linear-gradient(150deg,var(--card) 0%,rgba(0,0,0,.6) 100%);border:1px solid var(--stroke);border-radius:18px;padding:18px;box-shadow:0 24px 56px rgba(0,0,0,.85),0 0 60px rgba(255,0,0,.14);display:flex;flex-direction:column;gap:10px;transition:transform .28s ease, box-shadow .28s ease, border-color .28s ease;transform-style:preserve-3d;will-change:transform;opacity:0;transform:translateY(18px)}
    .card:hover{transform:perspective(900px) rotateX(2deg) rotateY(-2deg) translateZ(6px);box-shadow:0 36px 84px rgba(0,0,0,.92), 0 0 90px rgba(255,59,0,.22);border-color:rgba(255,255,255,.18)}
    .card.in{opacity:1;transform:none;animation:fadeUp .6s ease both}

    .badge{position:absolute;top:-11px;left:14px;background:linear-gradient(90deg,#ff0000,#ff7b00);color:#000;font-size:11px;font-weight:800;padding:6px 10px;border-radius:999px;box-shadow:0 10px 18px rgba(255,80,0,.45);animation:pulse 2.2s ease-in-out infinite}
    .title{font-size:18px;font-weight:800}
    .desc{font-size:13px;color:var(--muted);line-height:1.45}

    .btn{display:block;text-decoration:none;text-align:center;padding:12px 14px;border-radius:14px;font-size:14px;font-weight:800;color:#000;background:linear-gradient(90deg,#ff0000,#ff7b00);box-shadow:0 16px 26px rgba(255,90,0,.35);transition: transform .22s ease, box-shadow .22s ease, filter .22s ease;transform-style:preserve-3d;will-change:transform}
    .btn:hover{transform:perspective(700px) translateZ(12px) scale(1.06) rotateX(2deg);box-shadow:0 28px 44px rgba(255,90,0,.5);filter:brightness(1.05)}
    .btn.wa{background:radial-gradient(circle at 0% 0%, var(--wa1), var(--wa2));box-shadow:0 18px 30px rgba(18,140,126,.45)}

    .footer{text-align:center;color:var(--muted2);font-size:11px;margin-top:10px}
    .footer a{color:var(--muted2);text-decoration:none}

    .fab-nav{position:fixed;right:16px;bottom:calc(16px + env(safe-area-inset-bottom));display:flex;flex-direction:column;gap:12px;z-index:9999}
    .fab-btn{display:flex;align-items:center;gap:10px;background:radial-gradient(circle at 0% 0%,var(--wa1),var(--wa2));color:#000;text-decoration:none;font-weight:900;border-radius:50px;padding:12px 16px;box-shadow:0 20px 34px rgba(18,140,126,.45);transition:all .22s ease;transform-style:preserve-3d;animation:pulse 2.8s ease-in-out infinite;will-change:transform}
    .fab-btn:hover{transform:perspective(700px) translateZ(10px) scale(1.06);filter:brightness(1.05);box-shadow:0 28px 44px rgba(18,140,126,.65)}
    .fab-btn svg{width:18px;height:18px}
    @media(max-width:420px){.fab-btn span{display:none}}

    .to-top{position:fixed;left:16px;bottom:calc(16px + env(safe-area-inset-bottom));opacity:0;pointer-events:none;transition:opacity .25s ease;z-index:9999}
    .to-top.show{opacity:1;pointer-events:auto}
    .to-top a{display:flex;align-items:center;gap:8px;padding:10px 12px;border-radius:999px;background:linear-gradient(90deg,var(--brand1),var(--brand2));color:#000;font-weight:900;box-shadow:0 16px 28px rgba(255,90,0,.35);text-decoration:none}

    .toast{position:fixed;left:50%;bottom:calc(24px + env(safe-area-inset-bottom));transform:translateX(-50%);background:#161616;border:1px solid rgba(255,255,255,.12);color:#fff;padding:10px 14px;border-radius:12px;box-shadow:0 10px 24px rgba(0,0,0,.5);opacity:0;pointer-events:none;transition:opacity .2s ease;z-index:9999}
    .toast.show{opacity:1}

    /* Lead modal */
    .lead-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);display:none;align-items:center;justify-content:center;z-index:10000}
    .lead-card{width:min(92vw,420px);background:linear-gradient(160deg, rgba(20,20,20,.98), rgba(0,0,0,.78));border:1px solid rgba(255,255,255,.12);border-radius:18px;box-shadow:0 26px 58px rgba(0,0,0,.75);padding:18px;position:relative}
    .lead-title{font-weight:900;font-size:20px;letter-spacing:-.02em;margin-bottom:6px}
    .lead-sub{color:rgba(255,255,255,.65);font-size:13px;margin-bottom:14px}
    .lead-row{display:grid;gap:8px;margin:10px 0}
    .lead-row input, .lead-row select{width:100%;padding:12px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.04);color:#fff;outline:none;transition:border-color .15s ease; font-size:14px}
    .lead-row input:focus, .lead-row select:focus{border-color:#ffd166}
    .lead-actions{display:flex;gap:10px;margin-top:12px}
    .btn-primary{flex:1;background:linear-gradient(90deg,#ff0000,#ff7b00);color:#000;font-weight:900;border:0;border-radius:12px;padding:12px}
    .btn-ghost{background:transparent;color:#fff;border:1px solid rgba(255,255,255,.18);border-radius:12px;padding:12px}
    .lead-legal{font-size:11px;color:rgba(255,255,255,.55);margin-top:10px;line-height:1.3}
    .lead-legal a{color:rgba(255,255,255,.75);text-decoration:underline}
    .lead-close{position:absolute;top:10px;right:12px;background:transparent;border:0;color:#fff;font-weight:900;font-size:18px}
  </style>
</head>
<body>
  <!-- 3D dynamic spotlight -->
  <div class="spotlight" id="spotlight"></div>

  <!-- Black Friday floating bar -->
  <div class="bf-bar" id="bfBar" role="status" aria-live="polite">
    <span>BLACK FRIDAY</span>
    <span class="timer" id="bfTimer">--:--:--</span>
    <a href="./catalogo-smartphone-reale-v3.html" aria-label="Vai alle offerte Black Friday">Vai alle offerte ‚ûú</a>
  </div>

  <div id="rl-loader" aria-label="Caricamento in corso" role="status">
    <div class="rl-cube">
      <span class="face f1"></span><span class="face f2"></span><span class="face f3"></span>
      <span class="face f4"></span><span class="face f5"></span><span class="face f6"></span>
    </div>
    <p class="rl-loading-text">Caricamento‚Ä¶</p>
  </div>

  <main class="wrap">
    <header class="head">
      <div class="brand">
        Re Long Telefonia, Energia & Assistenza PC
        <span class="status-pill" id="storeStatus">Verifica orari‚Ä¶</span>
      </div>
      <div class="sub">Clicca sulla sezione di interesse</div>
    </header>

    <section class="grid" aria-label="Collegamenti rapidi Re Long">
      <article class="card" data-anim>
        <div class="badge" data-badge>SMARTPHONE A RATE</div>
        <div class="title">Scegli il tuo smartphone</div>
        <p class="desc">Finanziamento Vodafone & Compass senza busta paga con rate flessibili.</p>
        <a class="btn" href="./catalogo-smartphone-reale-v3.html">üì± Catalogo Digitale</a>
        <a class="btn wa" href="https://wa.me/3908119578844">Scrivici su WhatsApp</a>
      </article>

      <article class="card" data-anim>
        <div class="badge" data-badge>OFFERTE BUSINESS P.IVA</div>
        <div class="title">Fisso + Mobile con Energia per P.IVA</div>
        <p class="desc">Soluzioni per Partite IVA e Aziende.</p>
        <a class="btn" href="./Business+Energy2.html">Scopri l'offerta</a>
        <a class="btn wa" href="https://wa.me/3908119578844">Chatta con un consulente Business</a>
      </article>

      <article class="card" data-anim>
        <div class="badge" data-badge>ENERGIA CASA</div>
        <div class="title">Accendi la tua Energia</div>
        <p class="desc">Invia la foto della tua bolletta per una verifica immediata.</p>
        <a class="btn" href="./index.html">Vai all‚ÄôArea Energia</a>
        <a class="btn wa" href="https://wa.me/3908119578844">Inviaci la tua Bolletta</a>
      </article>

      <article class="card" data-anim>
        <div class="badge" data-badge>ASSISTENZA PC</div>
        <div class="title">Riparazioni & Upgrade</div>
        <p class="desc">Diagnosi immediata e upgrade su misura.</p>
        <a class="btn" href="./assistenza.html">Vai all‚Äôassistenza PC</a>
        <a class="btn wa" href="https://wa.me/3908119578844">Chatta con l'assistenza Tecnica</a>
      </article>

      <article class="card" data-anim>
        <div class="badge" data-badge>OFFERTE BUSINESS</div>
        <div class="title">Offerte Business Mobili</div>
        <p class="desc">Piani dedicati ad Aziende e Partite IVA</p>
        <a class="btn" href="./business.html">üì≤ Scopri offerte Mobili Business</a>
        <a class="btn wa" href="https://wa.me/3908119578844">Chatta con un Consulente Business</a>
      </article>
    </section>

    <p class="footer">
      <a href="https://maps.app.goo.gl/dwpNWoUwFQD4NppU6" target="_blank" rel="noopener">üìç Via Casalanno 31, Marano di Napoli</a>
      ‚Ä¢
      <a href="tel:+3908119578844">‚òéÔ∏è 08119578844</a>
    </p>
  </main>

  <div class="to-top" id="toTop"><a href="#" aria-label="Torna su">‚¨ÜÔ∏è Torna su</a></div>
  <div class="toast" role="status" aria-live="polite"></div>

  <!-- Lead form modal -->
  <div class="lead-overlay" id="leadModal" aria-hidden="true" role="dialog" aria-label="Richiesta contatto">
    <div class="lead-card">
      <button class="lead-close" id="leadClose" aria-label="Chiudi">√ó</button>
      <div class="lead-title">Ti aiutiamo noi? üëã</div>
      <div class="lead-sub">Lascia un contatto: ti rispondiamo su <b>WhatsApp</b> o chiamata entro poco.</div>
      <div class="lead-row">
        <input id="leadName" type="text" placeholder="Nome e Cognome" autocomplete="name">
        <input id="leadPhone" type="tel" placeholder="Telefono (es. 08119578844)" autocomplete="tel">
        <select id="leadTopic">
          <option value="Smartphone a rate">Smartphone a rate</option>
          <option value="Offerte Vodafone Business">Offerte Vodafone Business</option>
          <option value="Energia Casa">Energia Casa</option>
          <option value="Assistenza PC">Assistenza PC</option>
        </select>
      </div>
      <div class="lead-actions">
        <button class="btn-primary" id="leadSend">Invia su WhatsApp</button>
        <button class="btn-ghost" id="leadLater">Pi√π tardi</button>
      </div>
      <p class="lead-legal">
        Inviando accetti di essere ricontattato per l‚Äôargomento selezionato. Nessuno spam.
        <br>WhatsApp: <b>08119578844</b> ‚Äî <a href="https://maps.app.goo.gl/dwpNWoUwFQD4NppU6" target="_blank" rel="noopener">Come raggiungerci</a>
      </p>
    </div>
  </div>

  <div class="fab-nav" aria-label="Azioni rapide">
    <a class="fab-btn" href="https://maps.app.goo.gl/dwpNWoUwFQD4NppU6" target="_blank" rel="noopener" aria-label="Portami allo Store">
      <svg fill="currentColor" viewBox="0 0 24 24"><path d="M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5A2.5 2.5 0 1112 6.5a2.5 2.5 0 010 5z"/></svg>
      <span>Portami allo Store</span>
    </a>
    <a class="fab-btn" href="tel:+3908119578844" aria-label="Chiama il negozio">
      <svg fill="currentColor" viewBox="0 0 24 24"><path d="M6.62 10.79a15.05 15.05 0 006.59 6.59l2.2-2.2a1 1 0 011.01-.24c1.12.37 2.33.57 3.58.57a1 1 0 011 1V21a1 1 0 01-1 1C10.4 22 2 13.6 2 3a1 1 0 011-1h3.5a1 1 0 011 1c0 1.25.2 2.46.57 3.58a1 1 0 01-.24 1.01l-2.2 2.2z"/></svg>
      <span>Chiamaci</span>
    </a>
  </div>

  <script>
    // Loader lock
    document.documentElement.classList.add('rl-lock'); document.body.classList.add('rl-lock');
    function hideLoader(){
      const ld = document.getElementById('rl-loader');
      if(!ld) return;
      ld.classList.add('hidden');
      setTimeout(()=>{
        document.documentElement.classList.remove('rl-lock');
        document.body.classList.remove('rl-lock');
        ld.remove && ld.remove();
      }, 500);
    }
    window.addEventListener('load', hideLoader);
    setTimeout(hideLoader, 3500);

    // To-top visibility
    const toTop = document.getElementById('toTop');
    const onScroll = ()=>{ (window.scrollY > 250) ? toTop.classList.add('show') : toTop.classList.remove('show'); };
    window.addEventListener('scroll', onScroll, {passive:true}); onScroll();

    function showToast(msg){
      let t = document.querySelector('.toast');
      if(!t){ t = document.createElement('div'); t.className='toast'; document.body.appendChild(t); }
      t.textContent = msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'), 2200);
    }

    // Internal link guard
    document.addEventListener('click', async (e)=>{
      const a = e.target.closest('a'); if(!a) return;
      const url = new URL(a.href, location.href);
      const isInternal = url.origin === location.origin && /\.html?$/.test(url.pathname);
      if(isInternal){
        e.preventDefault();
        try{
          const res = await fetch(url.href, {method:'HEAD', cache:'no-store'});
          if(res.ok){ location.href = url.href; }
          else { showToast('Pagina non trovata. Ti riportiamo alla Home.'); setTimeout(()=>location.href='./', 1000); }
        }catch(_){
          showToast('Impossibile aprire la pagina. Riprova o torna alla Home.'); setTimeout(()=>location.href='./', 1200);
        }
      }
    }, false);

    // 3D Spotlight follow
    (function(){
      const sp = document.getElementById('spotlight');
      const reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if(!sp) return;
      const move = (x,y)=>{
        sp.style.background = `radial-gradient(600px circle at ${x}px ${y}px, rgba(255,123,0,.5), rgba(255,0,0,.15) 40%, transparent 60%)`;
      };
      window.addEventListener('pointermove', (e)=>{ if(reduce) return; move(e.clientX, e.clientY); }, {passive:true});
      window.addEventListener('scroll', ()=>{ sp.classList.toggle('softer', window.scrollY>60); }, {passive:true});
    })();

    // On-scroll animations (IntersectionObserver)
    (function(){
      const obs = new IntersectionObserver((entries)=>{
        entries.forEach(en=>{ if(en.isIntersecting){ en.target.classList.add('in'); obs.unobserve(en.target); } });
      }, {threshold: .18});
      document.querySelectorAll('[data-anim]').forEach(el=>obs.observe(el));
    })();

    // Black Friday countdown (to Nov 28, 2025 23:59:59 Europe/Rome)
    (function(){
      const timer = document.getElementById('bfTimer');
      const bar = document.getElementById('bfBar');
      if(!timer || !bar) return;
      // target date in local time (Europe/Rome). Adjust if needed.
      const target = new Date('2025-11-28T23:59:59+01:00');
      const tick = ()=>{
        const now = new Date();
        let diff = (target - now);
        if(diff <= 0){ timer.textContent = 'ULTIME ORE!'; bar.style.filter='brightness(1.05)'; return; }
        const d = Math.floor(diff/86400000); diff -= d*86400000;
        const h = Math.floor(diff/3600000); diff -= h*3600000;
        const m = Math.floor(diff/60000); diff -= m*60000;
        const s = Math.floor(diff/1000);
        timer.textContent = `${String(d).padStart(2,'0')}g ${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
      };
      tick(); setInterval(tick, 1000);
    })();

    // Store live status (configurable hours Europe/Rome)
    (function(){
      const pill = document.getElementById('storeStatus'); if(!pill) return;
      // Orari tipici (modifica se necessario): Lun-Sab 9:00‚Äì13:30, 15:30‚Äì20:00. Domenica chiuso.
      const HOURS = {
        0: [], // Domenica
        1: [[9,0,13,30],[15,30,20,0]], // Luned√¨
        2: [[9,0,13,30],[15,30,20,0]], // Marted√¨
        3: [[9,0,13,30],[15,30,20,0]], // Mercoled√¨
        4: [[9,0,13,30],[15,30,20,0]], // Gioved√¨
        5: [[9,0,13,30],[15,30,20,0]], // Venerd√¨
        6: [[9,0,13,30],[15,30,20,0]], // Sabato
      };
      const fmt = (h,m)=>`${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}`;
      const now = new Date();
      const day = now.getDay();
      const segs = HOURS[day]||[];
      const mins = now.getHours()*60 + now.getMinutes();
      let open=false, nextOpen=null, closeAt=null;
      // Today
      for(const [sh,sm,eh,em] of segs){
        const s = sh*60+sm, e = eh*60+em;
        if(mins>=s && mins<e){ open=true; closeAt=[eh,em]; break; }
        if(mins < s && !nextOpen){ nextOpen=[sh,sm]; }
      }
      // Next day search if closed for today
      if(!open && !nextOpen){
        for(let i=1;i<=7;i++){
          const d=(day+i)%7; const arr=HOURS[d]; if(arr && arr.length){ nextOpen=[arr[0][0],arr[0][1]]; break; }
        }
      }
      if(open){
        pill.textContent = `Aperto ‚Ä¢ chiude alle ${fmt(...closeAt)}`;
        pill.classList.add('status-open'); pill.classList.remove('status-closed');
      } else if(nextOpen){
        pill.textContent = `Chiuso ‚Ä¢ apre alle ${fmt(...nextOpen)}`;
        pill.classList.add('status-closed'); pill.classList.remove('status-open');
      } else {
        pill.textContent = 'Chiuso'; pill.classList.add('status-closed');
      }
    })();

    // Lead modal triggers
    (() => {
      const overlay = document.getElementById('leadModal');
      const closeBtn = document.getElementById('leadClose');
      const laterBtn = document.getElementById('leadLater');
      const sendBtn  = document.getElementById('leadSend');
      const nameEl = document.getElementById('leadName');
      const phoneEl = document.getElementById('leadPhone');
      const topicEl = document.getElementById('leadTopic');
      const LS_KEY = 'rl_lead_dismissed_until';
      function showLead(){
        const until = Number(localStorage.getItem(LS_KEY) || 0);
        if (Date.now() < until) return;
        overlay.style.display='flex';
        overlay.setAttribute('aria-hidden','false');
      }
      function hideLead(days=30){
        overlay.style.display='none';
        overlay.setAttribute('aria-hidden','true');
        localStorage.setItem(LS_KEY, String(Date.now() + days*24*60*60*1000));
      }
      setTimeout(showLead, 12000);
      let firedScroll=false;
      window.addEventListener('scroll', () => {
        if (firedScroll) return;
        const scrolled = (window.scrollY + window.innerHeight) / document.documentElement.scrollHeight;
        if (scrolled > 0.6){ firedScroll=true; showLead(); }
      }, {passive:true});
      document.addEventListener('mouseleave', (e) => { if(e.clientY <= 0) showLead(); });
      closeBtn.addEventListener('click', () => hideLead(30));
      laterBtn.addEventListener('click', () => hideLead(3));
      overlay.addEventListener('click', (e) => { if(e.target === overlay) hideLead(3); });
      sendBtn.addEventListener('click', () => {
        const name  = nameEl.value.trim();
        const phone = phoneEl.value.replace(/\D+/g,'');
        const topic = topicEl.value;
        if (!name || phone.length < 7){ alert('Inserisci nome e un numero valido.'); return; }
        const msg = `Ciao Re Long, sono ${name}. Il mio numero √® ${phone}. Vorrei info su: ${topic}.`;
        const url = `https://wa.me/3908119578844?text=${encodeURIComponent(msg)}`;
        window.open(url, '_blank');
        hideLead(30);
      });
    })();

    // Enrich WhatsApp buttons with dynamic templates
    (function(){
      const WA_BASE = "https://wa.me/3908119578844?text=";
      const templates = {
        "SMARTPHONE A RATE": "Ciao Re Long, vorrei informazioni per prendere uno smartphone a rate (Vodafone & Compass). Mi aiuti? üì±",
        "OFFERTE BUSINESS P.IVA": "Ciao Re Long, sono un'azienda/Partita IVA. Vorrei info sulle offerte Vodafone Business. Possiamo sentirci? üßæ",
        "ENERGIA CASA": "Ciao Re Long, ti invio la mia bolletta luce per una verifica risparmio. Mi consigli l‚Äôofferta migliore? ‚ö°",
        "ASSISTENZA PC": "Ciao Re Long, ho bisogno di assistenza per il mio PC. Posso inviarti foto/video del problema? üß∞",
        "OFFERTE BUSINESS": "Ciao Re Long, vorrei scoprire le offerte Mobili Business per Partite IVA. Grazie! üì≤"
      };
      document.querySelectorAll("article.card .btn.wa").forEach((a)=>{
        try{
          const card   = a.closest("article.card");
          const badge  = card?.querySelector(".badge")?.textContent?.trim() || "";
          const title  = card?.querySelector(".title")?.textContent?.trim() || "";
          let msg = templates[badge] || `Ciao Re Long, vorrei informazioni su: ${title}. Grazie!`;
          a.href = WA_BASE + encodeURIComponent(msg);
          a.setAttribute("rel","noopener");
        }catch(_){}
      });
    })();

    // Gentle haptics for touch
    (() => {
      const isTouch = window.matchMedia('(pointer: coarse)').matches;
      const canVibrate = 'vibrate' in navigator && !window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (!isTouch || !canVibrate) return;
      const SELECTOR = 'a, button, .btn, .fab-btn';
      const VIB_TAP = [10];
      const VIB_STRONG = [14, 30, 12];
      document.addEventListener('pointerdown', (e) => {
        const el = e.target.closest(SELECTOR);
        if (!el) return;
        if (el.classList.contains('fab-btn')) { navigator.vibrate(VIB_STRONG); } else { navigator.vibrate(VIB_TAP); }
      }, { passive: true });
    })();

    // Dynamic badges (rotate messaging, emphasize BF week)
    (function(){
      const now = new Date();
      const bfStart = new Date('2025-11-24T00:00:00+01:00');
      const bfEnd   = new Date('2025-11-30T23:59:59+01:00');
      const isBF = now >= bfStart && now <= bfEnd;
      const cycles = [
        'BLACK FRIDAY', 'LIMITED', 'üî• HOT', 'NUOVO', 'MIGLIOR PREZZO'
      ];
      const badges = Array.from(document.querySelectorAll('[data-badge]'));
      if(!badges.length) return;
      let i=0;
      setInterval(()=>{
        badges.forEach((b)=>{
          if(isBF){ b.textContent = 'BLACK FRIDAY'; }
          else { b.textContent = cycles[i % cycles.length]; }
        });
        i++;
      }, 2600);
    })();
  </script>
</body>
</html>
