<!DOCTYPE html>
<html lang="it" data-mode="totem-wrapper">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Re Long • Totem Demo – Solo Home & Catalogo</title>
  <meta name="theme-color" content="#0a0a0a" />
  <style>
    *{box-sizing:border-box;margin:0;padding:0;-webkit-font-smoothing:antialiased}
    :root{--stroke:rgba(255,255,255,.1);--tile:rgba(10,200,255,.28);--ok:#25D366;--txt:#e5f2ff;--glow:rgba(10,200,255,.45)}
    html,body{height:100%;background:#000}
    body{font-family:system-ui,-apple-system,"Inter",Roboto,sans-serif;color:#fff;overflow:hidden}
    .wrap{height:100dvh;display:grid;grid-template-rows:auto 1fr auto}

    header{position:sticky;top:0;z-index:5;background:linear-gradient(0deg,transparent,rgba(10,10,15,.7));backdrop-filter:blur(8px);border-bottom:1px solid var(--stroke)}
    .topbar{display:flex;align-items:center;justify-content:space-between;gap:.75rem;padding:.75rem 1rem}
    .brand{display:flex;align-items:center;gap:.6rem}
    .badge{font-size:.8rem;padding:.15rem .5rem;border:1px solid var(--stroke);border-radius:999px;color:#cde}
    .wa{display:inline-flex;align-items:center;gap:.35rem;border:1px solid var(--ok);padding:.3rem .6rem;border-radius:999px}

    .frame{position:relative;height:100%;}
    iframe#hub{position:absolute;inset:0;width:100%;height:100%;border:0;border-top:1px solid var(--stroke);z-index:1}

    .footer{display:flex;align-items:center;justify-content:space-between;padding:.5rem 1rem;border-top:1px solid var(--stroke);background:linear-gradient(180deg,rgba(6,7,12,.6),rgba(6,7,12,.95));backdrop-filter:blur(8px)}
    .hint{font-size:.9rem;color:#cbd5e1}
    .pill{border:1px solid var(--tile);padding:.25rem .55rem;border-radius:999px}
    .controls{display:flex;gap:.5rem;align-items:center}
    .btn{background:transparent;border:1px solid var(--stroke);color:#fff;border-radius:12px;padding:.45rem .7rem;cursor:pointer}
    .btn:hover{box-shadow:0 0 0 1px var(--tile) inset}

    /* Transizione */
    .fx{position:absolute;inset:0;pointer-events:none;z-index:3;display:grid;grid-template-rows:1fr auto auto 1fr;justify-items:center;align-items:center;opacity:0;transform:scale(1.02);background:radial-gradient(80% 50% at 50% 30%, rgba(0,0,0,.35) 0%, rgba(0,0,0,.75) 60%, rgba(0,0,0,.9) 100%);transition:opacity .5s ease, transform .5s ease}
    .fx.show{opacity:1;transform:scale(1)}
    .fxTitle{font-size:1.06rem;letter-spacing:.06em;color:var(--txt);padding:.5rem .9rem;border:1px solid var(--tile);border-radius:14px;background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));box-shadow:0 0 24px rgba(10,200,255,.22), inset 0 0 0 1px rgba(10,200,255,.2)}
    .fxSub{color:#bfe9ff;font-size:.9rem;margin-top:.4rem}
    .progress{width:min(560px,80%);height:8px;border-radius:999px;border:1px solid var(--tile);background:rgba(255,255,255,.06);overflow:hidden}
    .bar{width:0%;height:100%;background:linear-gradient(90deg, rgba(10,200,255,.8), rgba(124,200,255,.8));animation:load 1.8s ease-in-out infinite}
    @keyframes load{0%{width:0%}50%{width:75%}100%{width:100%}}

    /* Simulazioni (senza riquadri) */
    .sim{position:absolute;inset:0;pointer-events:none;z-index:2;opacity:0;transition:opacity .5s ease}
    .sim.show{opacity:1}
    .cursor{position:absolute;left:0;top:0;width:26px;height:26px;border-radius:50%;border:2px solid rgba(255,255,255,.95);box-shadow:0 0 0 6px rgba(10,200,255,.22),0 0 24px rgba(10,200,255,.35);transform:translate(-50%,-50%)}
    .label{position:absolute;transform:translate(-50%,-120%);background:rgba(6,10,18,.9);border:1px solid var(--tile);padding:.6rem .8rem;border-radius:12px;color:#e6f2ff;font-size:1.05rem;white-space:nowrap;box-shadow:0 8px 24px rgba(0,0,0,.35), inset 0 0 0 1px rgba(10,200,255,.12)}

    /* Tap evidente: spotlight + ripple + freccia */
    .spot{position:absolute;inset:0;pointer-events:none;z-index:2;opacity:0;transition:opacity .25s ease;--sx:50%; --sy:50%;background:radial-gradient(circle 120px at var(--sx) var(--sy), rgba(255,255,255,.0) 0 90px, rgba(0,0,0,.52) 92px)}
    .spot.show{opacity:1;animation:fadeSpot 1.1s ease forwards}
    @keyframes fadeSpot{0%{opacity:1}80%{opacity:.85}100%{opacity:0}}
    .ripple{position:absolute;left:0;top:0;width:1px;height:1px;border-radius:50%;transform:translate(-50%,-50%);opacity:.9;border:2px solid rgba(255,255,255,.9);box-shadow:0 0 0 8px rgba(10,200,255,.25), 0 0 22px var(--glow);animation:r1 .9s ease-out forwards}
    .r2{animation-name:r2}.r3{animation-name:r3}
    @keyframes r1{0%{width:0;height:0;opacity:.95}100%{width:120px;height:120px;opacity:0}}
    @keyframes r2{0%{width:0;height:0;opacity:.9}100%{width:170px;height:170px;opacity:0}}
    @keyframes r3{0%{width:0;height:0;opacity:.8}100%{width:220px;height:220px;opacity:0}}
    .arrow{position:absolute;left:0;top:0;transform:translate(-50%,-50%) rotate(-60deg);width:0;height:0;opacity:0;z-index:2;pointer-events:none;transition:transform .25s ease, opacity .25s ease}
    .arrow::before{content:"";position:absolute;left:0;top:0;border-left:14px solid transparent;border-right:14px solid transparent;border-bottom:24px solid rgba(255,255,255,.95);filter:drop-shadow(0 4px 12px rgba(10,200,255,.35));transform:translate(-50%,-100%)}
    .arrow::after{content:"";position:absolute;left:0;top:0;width:6px;height:54px;border-radius:3px;background:linear-gradient(180deg, rgba(255,255,255,.95), rgba(124,200,255,.9));transform:translate(-50%,-40%);box-shadow:0 0 18px rgba(10,200,255,.35)}
    .arrow.show{opacity:1;animation:arrowPulse 1s ease-in-out 1}
    @keyframes arrowPulse{0%{transform:translate(-50%,-50%) scale(.9)}50%{transform:translate(-50%,-50%) scale(1.05)}100%{transform:translate(-50%,-50%) scale(1)}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="topbar">
        <div class="brand">
          <svg width="26" height="26" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="10" stroke="url(#g)" stroke-width="2"/><defs><linearGradient id="g" x1="0" x2="24" y1="0" y2="24"><stop stop-color="#0ac8ff"/><stop offset="1" stop-color="#7cf"/></linearGradient></defs></svg>
          <strong>Re Long</strong>
          <span class="badge">Totem Demo • Hub ufficiale</span>
        </div>
        <span class="wa">WhatsApp <strong>08119578844</strong></span>
      </div>
    </header>

    <main class="frame">
      <!-- SOLO HOME & CATALOGO -->
      <iframe id="hub" title="Re Long Hub" allow="autoplay; clipboard-write"
              src="https://alessandroiascone.github.io/relong-nfc/index.html"></iframe>

      <!-- Transizione -->
      <div class="fx" id="fx">
        <div></div>
        <div>
          <div class="fxTitle" id="fxTitle">Caricamento…</div>
          <div class="fxSub" id="fxSub">Re Long • Caricamento sezione…</div>
        </div>
        <div class="progress"><div class="bar" id="bar"></div></div>
        <div></div>
      </div>

      <!-- Simulazioni -->
      <div class="sim" id="sim">
        <div class="cursor" id="cursor"></div>
        <div class="label" id="labelSim" style="left:50%;top:50%;display:none">azione</div>
        <div class="arrow" id="arrow"></div>
      </div>

      <!-- Spotlight tap -->
      <div class="spot" id="spot"></div>
    </main>

    <footer class="footer">
      <div class="hint" id="hint">Demo automatica attiva • muovi mouse/clicca per interrompere</div>
      <div class="controls">
        <button class="btn" id="prev">◀︎</button>
        <span class="pill" id="labelPage">index</span>
        <button class="btn" id="next">▶︎</button>
      </div>
    </footer>
  </div>

<script>
  // ========= CONFIG =========
  const BASE = 'https://alessandroiascone.github.io/relong-nfc/';

  // SOLO Home e Catalogo con simulazioni su rate/offerte
  const PLAYLIST = [
    { page:'index.html', title:'Home',
      actions:[
        {t:1200,type:'move',x:50,y:78,label:'Scorri promo del giorno'},
        {t:2800,type:'click',x:50,y:78},
        {t:5200,type:'move',x:50,y:22,label:'Vai al Catalogo'}
      ],
      dwell:18000
    },
    // Catalogo: più modelli con "Calcola rate"
    { page:'catalogo-smartphone-reale-v3.html', title:'Catalogo • iPhone 17 (Rate 24 mesi)',
      actions:[
        {t:900,type:'move',x:50,y:18,label:'Cerca/Filtra'},
        {t:2400,type:'move',x:28,y:55,label:'Apri • iPhone 17'},
        {t:3800,type:'click',x:28,y:55},
        {t:6200,type:'move',x:74,y:64,label:'Calcola rate'},
        {t:7600,type:'click',x:74,y:64},
        {t:9800,type:'move',x:74,y:74,label:'Seleziona 24 mesi'},
        {t:11200,type:'click',x:74,y:74},
        {t:13200,type:'move',x:74,y:84,label:'Invia richiesta WhatsApp'},
        {t:14600,type:'click',x:74,y:84}
      ],
      dwell:22000
    },
    { page:'catalogo-smartphone-reale-v3.html', title:'Catalogo • S25 Ultra (Rate 30 mesi)',
      actions:[
        {t:900,type:'move',x:50,y:18,label:'Filtra/Cerca'},
        {t:2400,type:'move',x:50,y:55,label:'Apri • Galaxy S25 Ultra'},
        {t:3800,type:'click',x:50,y:55},
        {t:6200,type:'move',x:74,y:64,label:'Calcola rate'},
        {t:7600,type:'click',x:74,y:64},
        {t:9800,type:'move',x:74,y:74,label:'Seleziona 30 mesi'},
        {t:11200,type:'click',x:74,y:74}
      ],
      dwell:20000
    },
    { page:'catalogo-smartphone-reale-v3.html', title:'Catalogo • Honor Magic V5 (Offerta + 20 mesi)',
      actions:[
        {t:800,type:'move',x:72,y:55,label:'Apri • Honor Magic V5'},
        {t:2200,type:'click',x:72,y:55},
        {t:4200,type:'move',x:50,y:30,label:'Offerta lampo'},
        {t:5400,type:'click',x:50,y:30},
        {t:7200,type:'move',x:74,y:64,label:'Calcola rate'},
        {t:8600,type:'click',x:74,y:64},
        {t:10800,type:'move',x:74,y:74,label:'Seleziona 20 mesi'},
        {t:12200,type:'click',x:74,y:74}
      ],
      dwell:21000
    },
    { page:'catalogo-smartphone-reale-v3.html', title:'Catalogo • Galaxy A55 (Rate 12 mesi)',
      actions:[
        {t:900,type:'move',x:28,y:72,label:'Visualizza • Galaxy A55'},
        {t:2200,type:'click',x:28,y:72},
        {t:4300,type:'move',x:74,y:64,label:'Calcola rate'},
        {t:5600,type:'click',x:74,y:64},
        {t:7800,type:'move',x:74,y:74,label:'Seleziona 12 mesi'},
        {t:9200,type:'click',x:74,y:74}
      ],
      dwell:18000
    }
  ];

  // ========= RIFERIMENTI =========
  const iframe = document.getElementById('hub');
  const fx = document.getElementById('fx');
  const fxTitle = document.getElementById('fxTitle');
  const labelPage = document.getElementById('labelPage');
  const sim = document.getElementById('sim');
  const cursor = document.getElementById('cursor');
  const labelSim = document.getElementById('labelSim');
  const spot = document.getElementById('spot');
  const arrow = document.getElementById('arrow');

  let step = 0, demo = true, rotTimer = null, idleTimer = null, hideTimer = null, actionTimers = [];

  // ========= UTIL =========
  function humanize(s){return s.replace('.html','').replace('.htm','').replace(/-/g,' ').replace(/\+/g,' ').replace(/\b\w/g,m=>m.toUpperCase());}
  function vw(x){return (x/100)*window.innerWidth}
  function vh(y){return (y/100)*window.innerHeight}
  function showOverlay(name){ fxTitle.textContent = name; fx.classList.add('show'); clearTimeout(hideTimer); }
  function hideOverlay(){ fx.classList.remove('show'); }
  function clearActions(){ actionTimers.forEach(t=>clearTimeout(t)); actionTimers=[]; sim.classList.remove('show'); labelSim.style.display='none'; arrow.style.opacity=0; }

  // Tap evidenziato: spotlight + ripple + freccia
  function showSpot(x,y){ spot.style.setProperty('--sx', vw(x)+'px'); spot.style.setProperty('--sy', vh(y)+'px'); spot.classList.remove('show'); void spot.offsetWidth; spot.classList.add('show'); }
  function ripple(x,y){ ['',' r2',' r3'].forEach(cls=>{ const r=document.createElement('div'); r.className='ripple'+cls; r.style.left=vw(x)+'px'; r.style.top=vh(y)+'px'; sim.appendChild(r); setTimeout(()=>r.remove(),950); }); }
  function showArrow(x,y,angle=-60){ arrow.style.left=vw(x)+'px'; arrow.style.top=(vh(y)-90)+'px'; arrow.style.transform=`translate(-50%,-50%) rotate(${angle}deg)`; arrow.classList.remove('show'); void arrow.offsetWidth; arrow.classList.add('show'); setTimeout(()=>arrow.classList.remove('show'),900); }

  function runActions(list){
    sim.classList.add('show');
    list.forEach(a=>{
      actionTimers.push(setTimeout(()=>{
        if(a.type==='move'){
          cursor.style.left = vw(a.x)+'px';
          cursor.style.top  = vh(a.y)+'px';
          if(a.label){ labelSim.textContent = a.label; labelSim.style.left = vw(a.x)+'px'; labelSim.style.top = vh(a.y)+'px'; labelSim.style.display='block'; } else { labelSim.style.display='none'; }
        }
        if(a.type==='click'){ ripple(a.x,a.y); showSpot(a.x,a.y); showArrow(a.x,a.y, a.angle ?? -60); }
      }, a.t));
    });
  }

  // ========= NAVIGAZIONE =========
  function go(i){
    step = (i + PLAYLIST.length) % PLAYLIST.length;
    const s = PLAYLIST[step];
    showOverlay(humanize(s.title || s.page));
    clearActions();
    iframe.src = BASE + s.page;
    labelPage.textContent = humanize(s.title || s.page);
    hideTimer = setTimeout(hideOverlay, 3500);
  }

  iframe.addEventListener('load', ()=>{
    hideOverlay();
    clearActions();
    const s = PLAYLIST[step];
    if(s.actions?.length){ setTimeout(()=>runActions(s.actions), 600); }
    if(demo){ clearTimeout(rotTimer); rotTimer = setTimeout(()=>{ next() }, s.dwell || 20000); }
  });

  function next(){ go(step+1) }
  function prev(){ go(step-1) }
  document.getElementById('next').addEventListener('click',()=>{ stopDemo(); next() });
  document.getElementById('prev').addEventListener('click',()=>{ stopDemo(); prev() });

  // ========= DEMO MODE =========
  function startDemo(){ demo = true; const s = PLAYLIST[step] || {}; clearTimeout(rotTimer); rotTimer = setTimeout(()=>{ next() }, s.dwell || 20000); }
  function stopDemo(){ if (!demo) return; demo=false; document.getElementById('hint').textContent='Demo disattivata'; clearTimeout(rotTimer); clearTimeout(idleTimer); clearActions(); }
  function resetIdle(){ if(!demo) return; clearTimeout(idleTimer); idleTimer = setTimeout(startDemo, 45000); } // parte dopo 45s

  ['click','mousemove','keydown','touchstart'].forEach(ev=>window.addEventListener(ev, stopDemo));

  // Avvio
  go(0);
  resetIdle();
</script>
</body>
</html>
